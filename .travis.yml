language: node_js

os:
  - linux
  
dotnet: 5.0

mono: none

node_js:
  - "20.10.0"


dist: focal
services:
      - mysql
env:
  - CXX=g++-4.8
before_install:
  - npm install -g grunt-cli
install:
  - wget https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb -O packages-microsoft-prod.deb
  - sudo dpkg -i packages-microsoft-prod.deb
  - sudo apt-get update
  - sudo apt-get install -y apt-transport-https
  - sudo apt-get update
  - sudo apt-get install -y dotnet-sdk-5.0
  - npm install -q

before_script:
  - mysql -e "create database IF NOT EXISTS test;" -uroot
  - npm install -g grunt-cli
  - npm install -g bower
  - bower install ./client/bower.json

script:
  - dotnet restore
  - dotnet build
  - EDGE_USE_CORECLR=1 npm test
