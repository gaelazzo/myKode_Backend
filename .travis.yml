language: node_js

os:
  - linux
  
dotnet: 5.0

mono: none

node_js:
  - "20.10.0"


dist: focal
services:
      - mysql
env:
  - CXX=g++-4.8
before_install:
  - npm install -g grunt-cli
install:
  - wget https://download.visualstudio.microsoft.com/download/pr/4f11b8a7-3996-4c91-9ab2-2b1b7b3cd70a/6cb7f3f9c7022b94f62c997a28d6e404/dotnet-sdk-5.0.301-linux-x64.tar.gz -O dotnet.tar.gz
  - mkdir -p $HOME/dotnet
  - tar zxf dotnet.tar.gz -C $HOME/dotnet
  - export DOTNET_ROOT=$HOME/dotnet
  - export PATH=$PATH:$HOME/dotnet
  - npm install -q

before_script:
  - mysql -e "create database IF NOT EXISTS test;" -uroot
  - npm install -g grunt-cli
  - npm install -g bower
  - bower install ./client/bower.json

script:
  - dotnet restore
  - dotnet build
  - EDGE_USE_CORECLR=1 npm test
